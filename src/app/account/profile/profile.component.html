<div class="container">
    <div class="card">
        <h2>{{ isEditing ? 'Edit Your Profile' : 'View Profile' }}</h2>

        <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" *ngIf="isEditing; else viewMode">

            <!-- First Name -->
            <div class="form-group">
                <label>First Name</label>
                <input type="text" formControlName="firstName" />
                <div *ngIf="submitted && f.firstName.errors" class="error">
                    <span *ngIf="f.firstName.errors.required">First Name is required</span>
                    <span *ngIf="f.firstName.errors.minlength">Minimum 2 characters required</span>
                </div>
            </div>

            <!-- Last Name -->
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" formControlName="lastName" />
                <div *ngIf="submitted && f.lastName.errors" class="error">
                    <span *ngIf="f.lastName.errors.required">Last Name is required</span>
                    <span *ngIf="f.lastName.errors.minlength">Minimum 2 characters required</span>
                </div>
            </div>

            <!-- Email -->
            <div class="form-group">
                <label>Email</label>
                <input type="email" formControlName="email" />
                <div *ngIf="submitted && f.email.errors" class="error">
                    <span *ngIf="f.email.errors.required">Email is required</span>
                    <span *ngIf="f.email.errors.email">Invalid email format</span>
                </div>
            </div>

            <!-- Address -->
            <div class="form-group">
                <label>Address</label>
                <input type="text" formControlName="address" />
                <div *ngIf="submitted && f.address.errors" class="error">
                    <span *ngIf="f.address.errors.required">Address is required</span>
                </div>
            </div>

            <!-- Password Section -->
            <h3>Password Changes</h3>

            <!-- Current Password -->
            <div class="form-group">
                <label>Current Password</label>
                <input type="password" formControlName="currentPassword" />
            </div>

            <!-- New Password -->
            <div class="form-group">
                <label>New Password</label>
                <input type="password" formControlName="newPassword" />
                <div *ngIf="submitted && f.newPassword.errors" class="error">
                    <span *ngIf="f.newPassword.errors.minlength">Minimum 6 characters required</span>
                </div>
            </div>

            <!-- Confirm New Password -->
            <div class="form-group">
                <label>Confirm New Password</label>
                <input type="password" formControlName="confirmPassword" />
                <div *ngIf="submitted && isPasswordMismatch()" class="error">
                    <span>Passwords do not match</span>
                </div>
            </div>

            <!-- Buttons -->
            <div class="btn-group">
                <button type="button" (click)="toggleEdit()">Cancel</button>
                <button type="submit" [disabled]="profileForm.invalid">Save Changes</button>
            </div>
        </form>

        <!-- View Mode -->
        <ng-template #viewMode>
            <div class="view-group">
                <p><strong>First Name:</strong> {{ profileForm.value.firstName }}</p>
                <p><strong>Last Name:</strong> {{ profileForm.value.lastName }}</p>
                <p><strong>Email:</strong> {{ profileForm.value.email }}</p>
                <p><strong>Address:</strong> {{ profileForm.value.address }}</p>
                <button (click)="toggleEdit()">Edit Profile</button>
            </div>
        </ng-template>
    </div>
</div>